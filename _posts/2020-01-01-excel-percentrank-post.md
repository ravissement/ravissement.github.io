---
published: true
---

## Excel PercentRank Post  
  
    

### Excel PERCENTRANK(백분위 순위 함수)에 대한 출력 공식 정리
백분위 순위 함수를 프로그래밍으로 구현하기 위해 공식을 분석해 본다.

※ Excel에서 PERCENTRANK 함수의 기본 사용 : PERCENTRANK(범위, 입력값, 자릿수)
 
### PERCENTRANK.INC()
: 데이터 집합에서 특정 값의 백분율 순위(0과 1을 포함하여 0에서 1 사이의 범위)를 반환.  

 
입력값보다 작은 수의 갯수 :  'A'  
입력값보다 큰 수의 갯수:  'B'  
전체 데이터의 갯수 : 'C' 
입력값 :  'N'  

※ 단, 중복값은 입력값보다 큰수의 갯수에 포함 시킨다.

입력값 'N' 에 대하여 백분위 순위는 = A / (B + A)  

즉, A/ (C - 1)   

 

### PERCENTRANK.EXC()
: 데이터 집합에서 특정 값의 백분율 순위(0과 1을 제외하고 0에서 1 사이의 범위)를 반환.  

 

입력값보다 작은 수의 갯수 :  'A'  
입력값보다 큰 수의 갯수:  'B'  
전체 데이터의 갯수 : 'C' 
입력값 :  'N'  

※ 단, 중복값은 입력값보다 큰수의 갯수에 포함 시킨다. 

입력값 'N' 에 대하여 백분위 순위는 = (A + 1) / (B + A) + 2   

즉, (A + 1) / (C+1)  


### 입력값이 분포에 없을 때

입력값(N)의 가장 가까운 작은 수(X)의 PercentRank(pA)와  
가장 가까운 큰 수(Y)의 PercentRank(pB) 사이의 (N-X)/(Y-X) 지점을 찾는다.  

즉, pA + ( (pB-pA) * ( (N-X)/(Y-X) ) )  
